(function(e){function t(t){for(var r,n,c=t[0],a=t[1],l=t[2],u=0,d=[];u<c.length;u++)n=c[u],s[n]&&d.push(s[n][0]),s[n]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);p&&p(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],r=!0,n=1;n<o.length;n++){var c=o[n];0!==s[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=o[0]))}return e}var r={},n={app:0},s={app:0},i=[];function c(e){return a.p+"js/"+({}[e]||e)+"."+{"chunk-66cb":"7d809ef2","chunk-7fc1":"aa272698","chunk-ac67":"82fd7303"}[e]+".js"}function a(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.e=function(e){var t=[],o={"chunk-66cb":1,"chunk-7fc1":1,"chunk-ac67":1};n[e]?t.push(n[e]):0!==n[e]&&o[e]&&t.push(n[e]=new Promise(function(t,o){for(var r="css/"+({}[e]||e)+"."+{"chunk-66cb":"8ca86376","chunk-7fc1":"45116ee6","chunk-ac67":"4e5d4f41"}[e]+".css",n=a.p+r,s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var c=s[i],l=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(l===r||l===n))return t()}var u=document.getElementsByTagName("style");for(i=0;i<u.length;i++){c=u[i],l=c.getAttribute("data-href");if(l===r||l===n)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var r=t&&t.target&&t.target.src||n,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.request=r,o(s)},d.href=n;var p=document.getElementsByTagName("head")[0];p.appendChild(d)}).then(function(){n[e]=0}));var r=s[e];if(0!==r)if(r)t.push(r[2]);else{var i=new Promise(function(t,o){r=s[e]=[t,o]});t.push(r[2]=i);var l,u=document.getElementsByTagName("head")[0],d=document.createElement("script");d.charset="utf-8",d.timeout=120,a.nc&&d.setAttribute("nonce",a.nc),d.src=c(e),l=function(t){d.onerror=d.onload=null,clearTimeout(p);var o=s[e];if(0!==o){if(o){var r=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src,i=new Error("Loading chunk "+e+" failed.\n("+r+": "+n+")");i.type=r,i.request=n,o[1](i)}s[e]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,u.appendChild(d)}return Promise.all(t)},a.m=e,a.c=r,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(o,r,function(t){return e[t]}.bind(null,r));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/static/",a.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var p=u;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"21bb":function(e,t,o){"use strict";var r=o("9fb8"),n=o.n(r);n.a},"2b80":function(e,t,o){},"3d7c":function(e,t,o){},4396:function(e,t,o){"use strict";var r=o("5213"),n=o.n(r);n.a},5213:function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);var r=o("2b0e"),n=o("2f62"),s=o("bc3a"),i=o.n(s);const c={namespaced:!0,state:{topics:{},selectedTopicId:void 0},getters:{selectedTopic(e){return e.selectedTopicId?e.topics[e.selectedTopicId]:void 0}},mutations:{REPLACEALL(e,t){e.topics={};for(let o of t)r["a"].set(e.topics,o.id,o)},UPSERT_TOPIC(e,t){r["a"].set(e.topics,t.id,t),void 0!==e.selectedTopic&&t.id==e.selectedTopic.id&&(e.selectedTopic=t)},SELECTTOPIC(e,t){e.selectedTopicId=t},DELETETOPIC(e,t){r["a"].delete(e.topics,t),void 0!==e.selectedTopic&&e.selectedTopic.id==t&&(e.selectedTopic=void 0)}},actions:{initialize({commit:e}){i.a.get("/api/topics/").then(t=>{const o=t.data;e("REPLACEALL",o)})},upsertTopic({commit:e,state:t},o){if(void 0===o.id)i.a.post("/api/topics/",o).then(t=>{e("UPSERT_TOPIC",t.data),e("SELECTTOPIC",t.data.id)});else{""===o.due&&(o.due=null),""===o.ready&&(o.ready=null);const n=t.topics[o.id],s={};for(var r in o)n[r]!=o[r]&&(s[r]=o[r]);Object.keys(s).length&&(e("UPSERT_TOPIC",o),i.a.patch("/api/topics/"+o.id+"/",s).then(t=>{e("UPSERT_TOPIC",t.data)}))}},selectTopic({commit:e},t){e("SELECTTOPIC",t)},deleteTopic({commit:e},t){i.a.delete("/api/topics/"+t.id+"/").then(o=>{e("DELETETOPIC",t.id)})}}};var a=c;const l={namespaced:!0,state:{searchText:"",filter:"urgent"},getters:{matchingTopics(e,t,o){const r=e.searchText.toLowerCase(),n=Object.values(o.topics.topics).filter(e=>{return e.title.toLowerCase().indexOf(r)>=0||e.text.toLowerCase().indexOf(r)>=0});return n},urgentTopics(e,t,o){return t.matchingTopics.filter(e=>e.score.sum>10)},readyTopics(e,t){return t.matchingTopics.filter(e=>e.score.sum<=10&&e.score.sum>=0&&!e.complete)},blockedTopics(e,t){return t.matchingTopics.filter(e=>e.score.sum<0&&!e.complete)},resultingTopics(e,t){let o;return o="all"===e.filter?t.matchingTopics:"ready"===e.filter?t.readyTopics:"blocked"===e.filter?t.blockedTopics:t.urgentTopics,o.sort((e,t)=>{return e.score.sum<t.score.sum?1:e.score.sum>t.score.sum?-1:e.ready<t.ready?-1:e.ready>t.ready?1:0})}},mutations:{SETSEARCHTEXT(e,t){e.searchText=t||""},SETFILTER(e,t){e.filter=t||"urgent"}},actions:{setSearchText({commit:e},t){e("SETSEARCHTEXT",t)},setFilter({commit:e},t){e("SETFILTER",t)}}};var u=l;i.a.defaults.xsrfCookieName="csrftoken",i.a.defaults.xsrfHeaderName="X-CSRFTOKEN",i.a.defaults.withCredentials=!0,r["a"].use(n["a"]);const d=new n["a"].Store({strict:!0,modules:{topics:a,search:u},state:{errors:null},mutations:{SET_ERRORS(e,t){e.errors=t},CLEAR_ERRORS(e){e.errors=null}},actions:{frameReceived({commit:e},t){"update_topic"==t.type?e("topics/UPSERT_TOPIC",t.payload):"delete_topic"==t.type&&e("topics/DELETETOPIC",t.payload)},setErrors({commit:e},t){e("SET_ERRORS",t)}}});i.a.interceptors.response.use(function(e){return e},function(e){if(403===e.response.status)window.location.href="/login/";else{const t=e.response.data.slice(0,e.response.data.indexOf("\n"));d.dispatch("setErrors",[e.message,t])}return Promise.reject(e)});var p=d,h=o("8c4f"),f=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"home"},[o("filter-selection",{attrs:{selection:e.filter},on:{selectionChanged:e.onFilterChanged}}),o("topic-list",{attrs:{topics:e.resultingTopics,showText:e.showText},on:{"topic-selected":e.onSelect}})],1)},m=[],v=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"topic-list"},[e.title?o("h1",[e._v(e._s(e.title))]):e._e(),o("v-list",e._l(e.topics,function(t){return o("v-list-tile",{key:t.id,attrs:{color:e.color(t)},on:{click:function(o){e.onClick(t)}}},[o("v-list-tile-content",[o("v-list-tile-title",{domProps:{textContent:e._s(t.title)}}),e.showText?o("v-list-tile-sub-title",{domProps:{textContent:e._s(t.text)}}):e._e()],1)],1)}))],1)},T=[],b=o("8860"),g=o("ce7e"),E=o("ba95"),_=o("5d23"),w={props:["title","topics","showText"],components:{VList:b["a"],VDivider:g["a"],VListTile:E["a"],VListTileContent:_["a"],VListTileTitle:_["c"],VListTileSubTitle:_["b"]},methods:{onClick(e){this.$emit("topic-selected",e)},color(e){return e.score.reasons["is overdue"]?"error":e.score.sum>60?"warning":e.complete?"success":void 0}}},C=w,S=(o("e0db"),o("2877")),x=Object(S["a"])(C,v,T,!1,null,null,null);x.options.__file="TopicList.vue";var k=x.exports,y=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-tabs",{attrs:{value:e.selectionIdx,grow:!0},on:{change:e.onSelectionChanged}},e._l(e.filters,function(t){return o("v-tab",[e._v(e._s(t))])}))},O=[],P=o("fe57"),R=o("71a3");const $=["urgent","ready","blocked","all"];var L={props:["selection"],components:{VTabs:P["a"],VTab:R["a"]},computed:{selectionIdx(){return $.indexOf(this.selection)},filters(){return $}},methods:{onSelectionChanged(e){const t=$[e];this.$emit("selectionChanged",t)}}},A=L,j=(o("4396"),Object(S["a"])(A,y,O,!1,null,null,null));j.options.__file="FilterSelection.vue";var I=j.exports,V={name:"home",components:{TopicList:k,FilterSelection:I},computed:{resultingTopics(){return this.$store.getters["search/resultingTopics"]},showText(){return""!=this.$store.state.search.searchText},filter(){return this.$store.state.search.filter}},methods:{onSelect(e){this.$router.push(`/edit/${e.id}`)},onFilterChanged(e){this.$store.dispatch("search/setFilter",e)}}},B=V,F=(o("21bb"),Object(S["a"])(B,f,m,!1,null,null,null));F.options.__file="Home.vue";var N=F.exports;r["a"].use(h["a"]);var U=new h["a"]({routes:[{path:"/",name:"home",component:N},{path:"/new",name:"new",component:()=>Promise.all([o.e("chunk-66cb"),o.e("chunk-ac67")]).then(o.bind(null,"67bf"))},{path:"/edit/:id",name:"edit",component:()=>Promise.all([o.e("chunk-66cb"),o.e("chunk-7fc1")]).then(o.bind(null,"1071"))}]}),D=o("bb71");o("da64");r["a"].use(D["a"],{customProperties:!0,iconfont:"md"});var H=o("9483");Object(H["a"])("/static/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached(){console.log("Content has been cached for offline use.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});o("d5e8");var M=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app"},[e.showAddButton?o("v-btn",{attrs:{fab:"",fixed:"",bottom:"",right:"",color:"red"},on:{click:e.onNewTopic}},[o("v-icon",[e._v("add")])],1):e._e(),o("error-snackbar"),o("v-app",[o("v-toolbar",{attrs:{app:""}},[o("v-icon",[e._v("all_inbox")]),o("v-icon",[e._v("memory")]),o("v-toolbar-title",[o("router-link",{staticClass:"md-title",attrs:{to:{name:"home",params:{}}}},[e._v("ExoCortex")])],1),o("v-spacer"),e.showAddButton?o("v-text-field",{attrs:{value:e.searchText,placeholder:"Search","prepend-icon":"search",clearable:!0,"append-icon":e.searchText?"add":""},on:{input:e.onSearchTextChanged,"click:append":e.onAdd}}):e._e()],1),o("v-content",{attrs:{app:""}},[o("router-view")],1)],1)],1)},q=[],J=o("7496"),W=o("71d9"),X=o("2a7f"),z=o("549c"),K=o("a523"),G=o("8336"),Q=o("132d"),Y=o("9910"),Z=o("2677"),ee=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-snackbar",{attrs:{value:e.errors,top:!0,right:!0,"auto-height":!0,color:"error",timeout:0}},[o("div",e._l(e.errors,function(t){return o("div",[e._v(e._s(t))])})),o("v-btn",{attrs:{dark:"",flat:""},on:{click:e.clearErrors}},[e._v("Close")])],1)},te=[],oe=o("2db4"),re={components:{VSnackbar:oe["a"],VBtn:G["a"]},data(){return{showErrors:!1}},computed:{errors(){return this.$store.state.errors}},methods:{clearErrors(){this.$store.commit("CLEAR_ERRORS")}}},ne=re,se=(o("d8f3"),Object(S["a"])(ne,ee,te,!1,null,null,null));se.options.__file="ErrorSnackbar.vue";var ie=se.exports,ce={name:"app",components:{VApp:J["a"],VToolbar:W["a"],VToolbarTitle:X["a"],VContent:z["a"],VContainer:K["a"],VBtn:G["a"],VIcon:Q["a"],VSpacer:Y["a"],VTextField:Z["a"],ErrorSnackbar:ie},data(){return{showAddButton:!1}},computed:{searchText(){return this.$store.state.search.searchText}},created(){this.$store.dispatch("topics/initialize")},mounted(){this.showAddButton="/"===this.$router.currentRoute.path,this.$router.afterEach((e,t)=>{this.showAddButton="/"===this.$router.currentRoute.path})},methods:{onNewTopic(){this.$router.push("/new")},onSearchTextChanged(e){this.$store.dispatch("search/setSearchText",e)},onAdd(){const e={title:this.searchText,pinned:!0};this.$store.dispatch("topics/upsertTopic",e),this.$store.dispatch("search/setSearchText","")}}},ae=ce,le=(o("5c0b"),Object(S["a"])(ae,M,q,!1,null,null,null));le.options.__file="App.vue";var ue=le.exports;const de=window.location;var pe;pe="http:"===de.protocol?"ws:":"wss:",pe+="//"+de.host,pe+="/api/ws/updates/",r["a"].config.productionTip=!1,new r["a"]({store:p,router:U,render:e=>e(ue),created(){this.connect()},methods:{connect(){this.$ws=new WebSocket(pe),this.$ws.onmessage=(e=>{this.$store.dispatch("frameReceived",JSON.parse(e.data))}),this.$ws.onclose=(e=>{console.warn("WebSocket connection closed. Reconnecting in 2s."),setTimeout(()=>{this.connect()},2e3)}),this.$ws.onerror=(e=>{console.error("WebSocket Error:",e)})}}}).$mount("#app")},"5c0b":function(e,t,o){"use strict";var r=o("3d7c"),n=o.n(r);n.a},"9fb8":function(e,t,o){},d4ab:function(e,t,o){},d8f3:function(e,t,o){"use strict";var r=o("d4ab"),n=o.n(r);n.a},e0db:function(e,t,o){"use strict";var r=o("2b80"),n=o.n(r);n.a}});
//# sourceMappingURL=app.840a0bd2.js.map